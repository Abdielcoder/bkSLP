<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./assets/icons/favicon.ico" />
    <title>Tu Taxi</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./css/index.css" />
  </head>

  <body>
    <div class="container">
      <div class="bg_logo"></div>
      <div class="form_container">
        <div class="sub_form">
          <div class="loginForm">
            <div class="floating-image-container">
              <img
                src="/assets/img/Barra-Busqueda-slp2.png"
                alt="San Luis Potosi"
              />
            </div>
            <h2>Tu taxi</h2>
            <p>Portal Administrativo</p>
            <form>
              <input
                class="form_input"
                id="loginEmail"
                type="email"
                placeholder="Correo electronico"
                required
              />
              <input
                class="form_input"
                id="loginPassword"
                type="password"
                placeholder="Contrase単a"
                required
                minlength="8"
              />
              <a href="./reset_pwd.html">多Olvidaste tu Contrase単a?</a>
              <input id="loginSubmit" type="submit" value="Ingresar" />
              <p>Copyright &copy; <u>Tadi App.</u></p>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js"></script> -->
    <script type="module">
      import { login } from "./js/config.js";

      const inputEmail = document.querySelector("#loginEmail");
      const inputPass = document.querySelector("#loginPassword");
      const submitButton = document.querySelector("#loginSubmit");

      submitButton.addEventListener("click", async function (e) {
        e.preventDefault();
        const email = inputEmail.value;
        const pass = inputPass.value;
        await login(email, pass);
      });
    </script>
    <!-- <script type="module">
      import { logInWithEmail } from "./js/config/auth.js";
      // import { auth } from "./js/config/config.js";

      // const inputEmail = document.querySelector("#loginEmail");
      // const inputPass = document.querySelector("#loginPassword");
      // const submitButton = document.querySelector("#loginSubmit");

      submitButton.addEventListener("click", (e) => {
        const email = inputEmail.value;
        const pass = inputPass.value;
        e.preventDefault();
        const isValid = verifyPreAccess();
        if (isValid === false) return;
        logInWithEmail(email, pass);
      });

      // document.addEventListener("keyup", (e) => {
      //   if (e.which !== 13) return;
      //   const isValid = verifyPreAccess();
      //   if (isValid === false) return;
      //   logInWithEmail(inputEmail.value, inputPass.value);
      // });

      document.querySelectorAll("input.form_input").forEach((e) => {
        e.addEventListener("keyup", (t) => {
          toggleInputOutline(t.target, null);
        });
        e.addEventListener("click", (t) => {
          toggleInputOutline(t.target, null);
        });
      });

      const verifyPreAccess = () => {
        const isEmail = validateEmail(inputEmail.value);

        if (
          (inputEmail.value === "" || isEmail === false) &&
          inputPass.value === ""
        ) {
          alert("Favor de llenar los campos correctamente.");
          toggleInputOutline(inputEmail, false);
          toggleInputOutline(inputPass, false);
          return false;
        }
        if (inputEmail.value === "" || isEmail === false) {
          alert("Favor de introducir su correo correctamente.");
          toggleInputOutline(inputEmail, false);
          return false;
        }
        if (inputPass.value === "") {
          alert("Favor de introducir su contrase単a correctamente.");
          toggleInputOutline(inputPass, false);
          return false;
        }
        return true;
      };

      const toggleInputOutline = (itx, fx) => {
        if (fx === false) itx.style.outline = "1px solid #dc3545";
        if (fx === true || fx === null) itx.style.outline = "none";
        return;
      };

      const validateEmail = (ex) => {
        const pattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
        return pattern.test(ex);
      };

      // export const createUser = (u, p) => {
      //   const response = auth
      //     .createUserWithEmailAndPassword(u, p)
      //     .then((userCredential) => {
      //       const user = userCredential.user;
      //       return user;
      //     })
      //     .catch((error) => {
      //       const errorCode = error.code;
      //       const errorMessage = error.message;
      //       return false;
      //     });

      //   console.log(response);
      // };
    </script> -->
  </body>
</html>
